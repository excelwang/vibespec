# L2 叶子节点类型纯粹性约束

## 背景
L2 的叶子级别 item 应保持执行类型的纯粹性，不允许 agent 类型和 script 类型混合。

## 规则定义

### 类型分类
- **Agent 类型**: 需要 LLM 判断、上下文理解、语义分析、非确定性决策的操作
- **Script 类型**: 纯机械化、确定性、可完全自动化的操作

### 约束
1. L2 的每个叶子级别 item（最低层级子项）必须是纯 agent 类型或纯 script 类型
2. 不允许单个叶子 item 同时包含两种类型的职责
3. 如果某个 agent 类型的 item 中有部分工作可以 offload 给 script，则必须继续拆分该 item
4. 如果某个 script 类型的 item 中有部分工作需要 agent 判断，则必须继续拆分该 item
5. 拆分应持续进行，直到每个叶子节点都是纯粹的单一类型

### 验证方法
- 静态分析：检查叶子 item 的描述中是否混合了 agent 和 script 特征关键词
- Agent 特征词：语义分析、上下文、判断、推理、匹配、分类
- Script 特征词：遍历、计数、排序、解析、格式化、提取

## 目标层级
- **L1**: 新增 `CONTRACTS.LEAF_TYPE_PURITY` 合约定义规则
- **L2**: 在 `ARCHITECTURE.LAYER_MANAGER` 或新组件中增加验证逻辑
