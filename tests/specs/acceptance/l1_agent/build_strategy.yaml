spec_id: CONTRACTS.BUILD_STRATEGY
type: agent_contract
description: "Agent contracts for build strategy"

contracts:
  - id: GAP_ANALYSIS_FIRST
    requirement: "IMPLEMENTER MUST perform gap analysis before implementation"
    cases:
      - name: "Analyzes before coding"
        given:
          request: "Implement new feature"
        then:
          behavior: "Agent analyzes current state before making changes"
        evaluation: llm

  - id: INCREMENTAL_REFACTOR
    requirement: "IMPLEMENTER SHOULD prefer incremental changes over full rewrites"
    cases:
      - name: "Uses incremental"
        given:
          gap_percentage: 30
        then:
          behavior: "Agent makes incremental changes"
        evaluation: llm

  - id: REWRITE_THRESHOLD
    requirement: "Agent MUST request human approval if gap exceeds 70%"
    cases:
      - name: "Requests approval"
        given:
          gap_percentage: 75
        then:
          behavior: "Agent asks user for approval before large rewrite"
        evaluation: llm
