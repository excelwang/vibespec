spec_id: CONTRACTS.L3_TYPE_ANNOTATION
type: agent_contract
description: "Agent contracts for L3 type annotations"

contracts:
  - id: SCRIPT_THRESHOLD
    requirement: "Agent SHOULD assign SCRIPT type if task is deterministic and <100 LOC"
    cases:
      - name: "Assigns SCRIPT to simple task"
        given:
          task: "Sort list by timestamp"
          deterministic: true
          estimated_loc: 20
        then:
          behavior: "Agent assigns [Type: SCRIPT]"
        evaluation: llm

  - id: FALLBACK_RATIONALE
    requirement: "Agent SHOULD document rationale for PROMPT_FALLBACK items"
    cases:
      - name: "Documents reason"
        given:
          type: "PROMPT_FALLBACK"
        then:
          behavior: "Agent adds rationale explaining why fallback is needed"
        evaluation: llm

  - id: PROMPT_BATCHING
    requirement: "Agent SHOULD batch adjacent PROMPT_NATIVE items"
    cases:
      - name: "Batches adjacent"
        given:
          items:
            - type: PROMPT_NATIVE
            - type: PROMPT_NATIVE
        then:
          behavior: "Agent groups into single batch"
        evaluation: llm
