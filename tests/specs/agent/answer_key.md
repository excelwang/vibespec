# Vibe-Spec Certification Answer Key
**Date**: 2026-02-08 12:43:34

> This is the Standard Reference Answer Key generated by the Vibe-Spec Heuristic Adapter.

---

## Spec: CONTRACTS.BOOTSTRAP (agent_contract)

### Contract: SCOPE_INQUIRY
**Requirement**: Agent MUST ask user to describe project

#### Case: Asks for description
- **Context (Given)**: `{'project_state': 'new'}`
- **Expectation**: `Agent asks open-ended question about project goals`

**Reference Answer**:
```text
ðŸ¤– [Agent]: Welcome to Vibe-Spec! I see you're starting a fresh project. What is your vision? Please describe what you want to build.
```

### Contract: SCOPE_REFORM
**Requirement**: Agent MUST convert input to SHALL/SHALL NOT statements

#### Case: Reformulates scope
- **Context (Given)**: `{'user_input': 'I want to build a calculator'}`
- **Expectation**: `Agent creates In-Scope and Out-of-Scope sections`

**Reference Answer**:
```text
ðŸ“‹ [Analysis]:
- In-Scope: I want to build a calculator
- Out-of-Scope: (Derived from context)

> SHALL we proceed with creating the L0-VISION.md?
```

### Contract: APPROVAL_GATE
**Requirement**: Agent MUST get approval before creating files

#### Case: Requests approval
- **Context (Given)**: `{'action': 'create L0-VISION.md'}`
- **Expectation**: `Agent asks user for approval before file creation`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.BOOTSTRAP with context: {'action': 'create L0-VISION.md'}
```

---

## Spec: CONTRACTS.BUILD_STRATEGY (agent_contract)

### Contract: GAP_ANALYSIS_FIRST
**Requirement**: IMPLEMENTER MUST perform gap analysis before implementation

#### Case: Analyzes before coding
- **Context (Given)**: `{'request': 'Implement new feature'}`
- **Expectation**: `Agent analyzes current state before making changes`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.BUILD_STRATEGY with context: {'request': 'Implement new feature'}
```

### Contract: INCREMENTAL_REFACTOR
**Requirement**: IMPLEMENTER SHOULD prefer incremental changes over full rewrites

#### Case: Uses incremental
- **Context (Given)**: `{'gap_percentage': 30}`
- **Expectation**: `Agent makes incremental changes`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.BUILD_STRATEGY with context: {'gap_percentage': 30}
```

### Contract: REWRITE_THRESHOLD
**Requirement**: Agent MUST request human approval if gap exceeds 70%

#### Case: Requests approval
- **Context (Given)**: `{'gap_percentage': 75}`
- **Expectation**: `Agent asks user for approval before large rewrite`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.BUILD_STRATEGY with context: {'gap_percentage': 75}
```

---

## Spec: CONTRACTS.FORMAL_NOTATION (agent_contract)

### Contract: PREFER_FORMALISMS
**Requirement**: Agent SHOULD use diagrams in L2, pseudocode in L3

#### Case: Uses formal notation
- **Context (Given)**: `{'layer': 2, 'content_type': 'component description'}`
- **Expectation**: `Agent includes mermaid diagram`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.FORMAL_NOTATION with context: {'layer': 2, 'content_type': 'component description'}
```

---

## Spec: CONTRACTS.IDEAS_PIPELINE (agent_contract)

### Contract: LEVEL_SEEKING
**Requirement**: Agent MUST classify each idea to highest applicable layer

#### Case: Classifies to highest layer
- **Context (Given)**: `{'idea': 'Add validation for user input'}`
- **Expectation**: `Agent classifies to L1 (contract level)`

**Reference Answer**:
```text
ðŸ’¡ [Idea Captured]:
{
  "content": "Add validation for user input",
  "layer": "L1",
  "status": "new"
}
```

### Contract: DECOMPOSITION
**Requirement**: Agent MUST split mixed-level ideas and process sequentially

#### Case: Splits mixed idea
- **Context (Given)**: `{'idea': 'Add vision for caching and implement cache interface'}`
- **Expectation**: `Agent splits into L0 vision idea and L3 interface idea`

**Reference Answer**:
```text
ðŸ’¡ [Idea Captured]:
{
  "content": "Add vision for caching and implement cache interface",
  "layer": "L1",
  "status": "new"
}
```

### Contract: APPROVAL_REQUIRED
**Requirement**: Agent MUST pause for human review after creating idea file

#### Case: Pauses for approval
- **Context (Given)**: `{'action': 'Created new idea file'}`
- **Expectation**: `Agent asks user for approval before proceeding`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.IDEAS_PIPELINE with context: {'action': 'Created new idea file'}
```

### Contract: COMPILE_PROMPT
**Requirement**: Agent SHOULD prompt for compilation when ideas/ is empty

#### Case: Prompts for compile
- **Context (Given)**: `{'ideas_dir': 'empty'}`
- **Expectation**: `Agent suggests running compile`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.IDEAS_PIPELINE with context: {'ideas_dir': 'empty'}
```

### Contract: CONFLICT_RES
**Requirement**: Agent MUST resolve conflicts by latest timestamp

#### Case: Uses latest
- **Context (Given)**: `{'ideas': [{'timestamp': 1707300000, 'value': 'old'}, {'timestamp': 1707400000, 'value': 'new'}]}`
- **Expectation**: `Agent uses the newer value`

**Reference Answer**:
```text
âš¡ [Conflict Resolution]: Detected multiple idea versions. applying Strategy: LATEST_TIMESTAMP_WINS.
```

---

## Spec: CONTRACTS.L3_TYPE_ANNOTATION (agent_contract)

### Contract: SCRIPT_THRESHOLD
**Requirement**: Agent SHOULD assign SCRIPT type if task is deterministic and <100 LOC

#### Case: Assigns SCRIPT to simple task
- **Context (Given)**: `{'task': 'Sort list by timestamp', 'deterministic': True, 'estimated_loc': 20}`
- **Expectation**: `Agent assigns [Type: SCRIPT]`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.L3_TYPE_ANNOTATION with context: {'task': 'Sort list by timestamp', 'deterministic': True, 'estimated_loc': 20}
```

### Contract: FALLBACK_RATIONALE
**Requirement**: Agent SHOULD document rationale for PROMPT_FALLBACK items

#### Case: Documents reason
- **Context (Given)**: `{'type': 'PROMPT_FALLBACK'}`
- **Expectation**: `Agent adds rationale explaining why fallback is needed`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.L3_TYPE_ANNOTATION with context: {'type': 'PROMPT_FALLBACK'}
```

### Contract: PROMPT_BATCHING
**Requirement**: Agent SHOULD batch adjacent PROMPT_NATIVE items

#### Case: Batches adjacent
- **Context (Given)**: `{'items': [{'type': 'PROMPT_NATIVE'}, {'type': 'PROMPT_NATIVE'}]}`
- **Expectation**: `Agent groups into single batch`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.L3_TYPE_ANNOTATION with context: {'items': [{'type': 'PROMPT_NATIVE'}, {'type': 'PROMPT_NATIVE'}]}
```

---

## Spec: CONTRACTS.LEAF_TYPE_PURITY (agent_contract)

### Contract: DECOMPOSE_MIXED
**Requirement**: Agent MUST decompose mixed items until each leaf is pure

#### Case: Decomposes hybrid
- **Context (Given)**: `{'item': {'keywords': ['parse', 'semantic', 'decide']}}`
- **Expectation**: `Agent splits into Script part (parse) and Agent part (semantic, decide)`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.LEAF_TYPE_PURITY with context: {'item': {'keywords': ['parse', 'semantic', 'decide']}}
```

---

## Spec: CONTRACTS.REFLECT (agent_contract)

### Contract: CONTEXT_BASED
**Requirement**: Agent SHOULD extract ideas from current conversation

#### Case: Extracts insight
- **Context (Given)**: `{'conversation': 'We discussed adding a new caching layer'}`
- **Expectation**: `Agent extracts idea about caching`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REFLECT with context: {'conversation': 'We discussed adding a new caching layer'}
```

### Contract: HUMAN_REVIEW
**Requirement**: Agent MUST get approval before saving distilled ideas

#### Case: Gets approval
- **Context (Given)**: `{'extracted_ideas': ['Add caching']}`
- **Expectation**: `Agent presents ideas for user approval before saving`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REFLECT with context: {'extracted_ideas': ['Add caching']}
```

---

## Spec: CONTRACTS.REJECTION_HANDLING (agent_contract)

### Contract: AUTOMATED_RETRY
**Requirement**: Agent MAY self-correct up to 3 times for fixable errors

#### Case: Retries on syntax error
- **Context (Given)**: `{'error_type': 'syntax', 'attempt': 1}`
- **Expectation**: `Agent attempts to fix and retry`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REJECTION_HANDLING with context: {'error_type': 'syntax', 'attempt': 1}
```

### Contract: AUTOMATED_GIVEUP
**Requirement**: Agent MUST revert and halt after 3 failed retries

#### Case: Gives up after 3
- **Context (Given)**: `{'error_type': 'syntax', 'attempt': 3}`
- **Expectation**: `Agent reverts changes and stops`

**Reference Answer**:
```text
ðŸ›‘ [GIVE_UP]: Max retries reached. Reverting all changes to state before task.
```

### Contract: HUMAN_REJECTION
**Requirement**: Agent MUST revert to pre-task state on user rejection

#### Case: Reverts on rejection
- **Context (Given)**: `{'user_response': 'reject'}`
- **Expectation**: `Agent reverts all changes from task`

**Reference Answer**:
```text
Start Reverting... Done. State restored.
```

---

## Spec: CONTRACTS.REVIEW_PROTOCOL (agent_contract)

### Contract: SELF_AUDIT
**Requirement**: Agent MUST read full layer content after revision

#### Case: Agent reads after edit
- **Context (Given)**: `{'action': 'Agent edited L1-CONTRACTS.md'}`
- **Expectation**: `Agent calls view_file on L1-CONTRACTS.md`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REVIEW_PROTOCOL with context: {'action': 'Agent edited L1-CONTRACTS.md'}
```

### Contract: QUALITY_ALIGNMENT
**Requirement**: Agent SHOULD verify TARGET_PROJECT pillar alignment

#### Case: Checks pillars
- **Context (Given)**: `{'spec_tags': []}`
- **Expectation**: `Agent warns about missing pillar tags`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REVIEW_PROTOCOL with context: {'spec_tags': []}
```

### Contract: HIERARCHY_CHECK
**Requirement**: Agent MUST load parent layer before editing child

#### Case: Loads parent first
- **Context (Given)**: `{'target': 'L2'}`
- **Expectation**: `Agent reads L1 before editing L2`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REVIEW_PROTOCOL with context: {'target': 'L2'}
```

### Contract: OMISSION_CHECK
**Requirement**: Agent MUST verify all parent keys are represented in child

#### Case: Checks coverage
- **Context (Given)**: `{'parent_keys': ['A', 'B'], 'child_keys': ['A']}`
- **Expectation**: `Agent warns about missing B`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REVIEW_PROTOCOL with context: {'parent_keys': ['A', 'B'], 'child_keys': ['A']}
```

### Contract: REDUNDANCY
**Requirement**: Agent MUST flag duplicate definitions

#### Case: Flags duplicates
- **Context (Given)**: `{'items': ['A', 'A']}`
- **Expectation**: `Agent warns about duplicate A`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REVIEW_PROTOCOL with context: {'items': ['A', 'A']}
```

### Contract: CONTRADICTION
**Requirement**: Agent MUST flag conflicts with existing content

#### Case: Flags contradiction
- **Context (Given)**: `{'existing': 'MUST do X', 'new': 'MUST NOT do X'}`
- **Expectation**: `Agent errors on contradiction`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REVIEW_PROTOCOL with context: {'existing': 'MUST do X', 'new': 'MUST NOT do X'}
```

### Contract: NOTIFICATION
**Requirement**: Agent MUST present all findings during approval

#### Case: Shows findings
- **Context (Given)**: `{'findings': ['warning_1', 'error_1']}`
- **Expectation**: `Agent shows all findings to user`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REVIEW_PROTOCOL with context: {'findings': ['warning_1', 'error_1']}
```

### Contract: SEQUENTIAL_ONLY
**Requirement**: Agent MUST NOT edit multiple layers in one turn

#### Case: Single layer edit
- **Context (Given)**: `{'edit_request': 'Edit L1 and L2'}`
- **Expectation**: `Agent edits only one layer per turn`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REVIEW_PROTOCOL with context: {'edit_request': 'Edit L1 and L2'}
```

### Contract: SKILL_TRACEABILITY
**Requirement**: Agent MUST NOT edit SKILL.md without updating L3

#### Case: L3 before SKILL
- **Context (Given)**: `{'edit_request': 'Update SKILL.md'}`
- **Expectation**: `Agent updates L3 first`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.REVIEW_PROTOCOL with context: {'edit_request': 'Update SKILL.md'}
```

---

## Spec: CONTRACTS.SCRIPT_FIRST (agent_contract)

### Contract: PROACTIVE
**Requirement**: Agent MUST propose scripts for repetitive workflows

#### Case: Proposes script
- **Context (Given)**: `{'repetitions': 3, 'workflow': 'manual validation'}`
- **Expectation**: `Agent suggests creating a script`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.SCRIPT_FIRST with context: {'repetitions': 3, 'workflow': 'manual validation'}
```

---

## Spec: CONTRACTS.STRICT_TESTABILITY (agent_contract)

### Contract: MOCK_GENERATION
**Requirement**: Agent MUST generate mock objects for external interfaces

#### Case: Creates mocks
- **Context (Given)**: `{'interface': 'EXTERNAL_API'}`
- **Expectation**: `Agent creates mock implementation for testing`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.STRICT_TESTABILITY with context: {'interface': 'EXTERNAL_API'}
```

### Contract: MOCK_FIRST
**Requirement**: Agent SHOULD run tests in MOCK mode during development

#### Case: Uses mock first
- **Context (Given)**: `{'test_mode': 'development'}`
- **Expectation**: `Agent runs mock tests before real tests`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.STRICT_TESTABILITY with context: {'test_mode': 'development'}
```

---

## Spec: CONTRACTS.TESTING_WORKFLOW (agent_contract)

### Contract: TEST_GENERATION
**Requirement**: Agent MUST generate tests for uncovered L3 fixtures

#### Case: Generates tests
- **Context (Given)**: `{'uncovered_l3': ['SCANNER', 'PARSER']}`
- **Expectation**: `Agent creates test files for uncovered items`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.TESTING_WORKFLOW with context: {'uncovered_l3': ['SCANNER', 'PARSER']}
```

### Contract: HUMAN_APPROVAL_TEST
**Requirement**: Agent MUST request approval before saving generated tests

#### Case: Asks before save
- **Context (Given)**: `{'generated_test': 'test_scanner.py'}`
- **Expectation**: `Agent asks user approval before writing file`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.TESTING_WORKFLOW with context: {'generated_test': 'test_scanner.py'}
```

### Contract: RESULT_EVALUATION
**Requirement**: Agent SHOULD analyze failures and propose fixes

#### Case: Proposes fix
- **Context (Given)**: `{'test_result': 'FAIL', 'error': 'assertion error'}`
- **Expectation**: `Agent suggests fix for the failure`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.TESTING_WORKFLOW with context: {'test_result': 'FAIL', 'error': 'assertion error'}
```

---

## Spec: CONTRACTS.TRIGGERS (agent_contract)

### Contract: IDLE_BEHAVIOR
**Requirement**: Agent MUST enter Validation Mode when ideas/ empty and SKILL.md exists

#### Case: Enters validation mode
- **Context (Given)**: `{'ideas_dir': 'empty', 'skill_md': 'exists'}`
- **Expectation**: `Agent automatically runs validation`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.TRIGGERS with context: {'ideas_dir': 'empty', 'skill_md': 'exists'}
```

### Contract: EMPTY_PROMPT
**Requirement**: Agent MUST invite brainstorming when project empty

#### Case: Invites brainstorm
- **Context (Given)**: `{'project_state': 'empty'}`
- **Expectation**: `Agent asks user what they want to build`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.TRIGGERS with context: {'project_state': 'empty'}
```

---

## Spec: CONTRACTS.VALIDATION_MODE (agent_contract)

### Contract: REPORT
**Requirement**: Agent MUST summarize orphans, ratio warnings, terminology issues

#### Case: Reports findings
- **Context (Given)**: `{'validation_result': {'orphans': ['ORPHAN_A'], 'warnings': ['ratio warning']}}`
- **Expectation**: `Agent presents all findings to user`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.VALIDATION_MODE with context: {'validation_result': {'orphans': ['ORPHAN_A'], 'warnings': ['ratio warning']}}
```

### Contract: FIX_PROPOSAL
**Requirement**: Agent MUST generate ideas for found errors

#### Case: Creates fix ideas
- **Context (Given)**: `{'errors': ['dangling ref']}`
- **Expectation**: `Agent creates idea file to fix the error`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.VALIDATION_MODE with context: {'errors': ['dangling ref']}
```

### Contract: COMPILE_PROMPT
**Requirement**: Agent SHOULD prompt for compilation on pass

#### Case: Prompts for compile
- **Context (Given)**: `{'validation_result': 'all pass'}`
- **Expectation**: `Agent suggests running compile`

**Reference Answer**:
```text
[Agent Simulation] Processing CONTRACTS.VALIDATION_MODE with context: {'validation_result': 'all pass'}
```

---

